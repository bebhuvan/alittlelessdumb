<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CMS No Backend Test</title>
  <style>
    body { 
      margin: 0; 
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    .status {
      padding: 10px;
      background: #f0f0f0;
      border-radius: 4px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="status">
    <h3>CMS Loading Test</h3>
    <p id="status">Loading...</p>
  </div>
  
  <div id="nc-root"></div>
  
  <script>
    const status = document.getElementById('status');
    
    function updateStatus(msg) {
      status.innerHTML = msg;
      console.log(msg);
    }
    
    updateStatus('Starting CMS load test...');
    
    // Load DecapCMS
    const script = document.createElement('script');
    script.src = 'https://unpkg.com/decap-cms@^3.2.0/dist/decap-cms.js';
    script.onload = function() {
      updateStatus('DecapCMS script loaded. Available: ' + !!window.CMS);
      
      if (window.CMS) {
        try {
          updateStatus('Initializing CMS with test-repo backend...');
          
          window.CMS.init({
            config: {
              backend: {
                name: 'test-repo'
              },
              media_folder: 'content/static',
              public_folder: '/static',
              collections: [
                {
                  name: 'posts',
                  label: 'Posts',
                  folder: 'content',
                  create: true,
                  fields: [
                    { name: 'title', label: 'Title', widget: 'string' },
                    { name: 'body', label: 'Body', widget: 'markdown' }
                  ]
                }
              ]
            }
          });
          
          updateStatus('CMS initialization completed successfully!');
        } catch (error) {
          updateStatus('Error initializing CMS: ' + error.message);
        }
      } else {
        updateStatus('ERROR: DecapCMS not available after script load');
      }
    };
    
    script.onerror = function() {
      updateStatus('ERROR: Failed to load DecapCMS script');
    };
    
    document.head.appendChild(script);
  </script>
</body>
</html>
